# Курсовая работа по предмету Программная инженерия - Сервис доставки

Пестерников Данил (М8О-114М) - Вариант 6 - Сервис доставки

## Технологии

- MapStruct - для маппинга объектов
- Lombok - инструмент для уменьшения шаблонного кода
- Spring Web - для разработки веб-приложений
- Spring Data Jpa - для упрощения доступа и взаимодействия с базой данных через ORM.
- Spring Security - для обеспечения безопасности веб-приложений
- Springdoc - инструмент для автоматической генерации документации к API
- Postgres - реляционная база данных для хранения данных
- MongoDB - NOSQL база данных для хранения данных
- Liquibase - инструмент для управления миграциями баз данных

## Запуск приложения

1. Клонируйте репозиторий: `git clone https://github.com/E6L1PS/delivery-api`
2. Перейдите в директорию infrastructure: `cd delivery-api/infrastructure`
3. Если требуется, измените файл конфигурации `.env`.
4. Запустите скрипт по созданию образов: `build-images-layered.sh`
5. Перейдите в директорию проекта: `cd delivery-api`
6. Запустите контейнеры: `docker compose up --build -d`
7. API:
   api-gateway: `http://localhost:8080/`
   eureka-server: `http://localhost:8761/`
   config-server: `http://localhost:8888/`
 OpenApi Specification:
   user-service: `http://localhost:8081/swagger-ui/index.html`
   parcel-service: `http://localhost:8082/swagger-ui/index.html`
   delivery-service: `http://localhost:8083/swagger-ui/index.html`
8. Пользователь с ролью `ADMIN`: `username: admin, password: admin`
9. Grafana http://localhost:3000/
10. VictoriaMetrics http://localhost:8428/
P.S В папке ресурсов находятся все основные конфигурационные файлы, скрипты, changelog'и, csv-фалы, index.yaml:
path: `user-service/src/main/resource`

## Структура работы

Task-1:

1. Создать файлы с описанием «архитектуры» согласно вашему варианту задания
   в Structurizr Lite.
2. Требования к диаграммам:
    - Должна быть контекстная диаграмма
    - Должна быть диаграмма контейнеров
    - Должна быть диаграмма развертывания
    - Должно быть несколько динамических диаграмм

Task-2:
Должны выполняться следующие условия:

- Данные должны храниться в СУБД PostgreSQL;
- Должны быть созданы таблицы для каждой сущности из вашего задания;
- Интерфейс к сущностям должен предоставляться в соответствии со стилем REST;
- API должен быть специфицирован в OpenAPI 3.0 (должен хранится в index.yaml);
- Должен быть создан скрипт по созданию базы данных и таблиц, а также
  наполнению СУБД тестовыми значениями;
- Для сущности, отвечающей за хранение данных о пользователе (клиенте), для
  пользователей должен быть реализован интерфейс поиска по маске фамилии и
  имени, а также стандартные CRUD операции.
- Данные о пользователе должны включать логин и пароль. Пароль должен
  храниться в закрытом виде (хэширован)

Task-3:
Должны выполняться следующие условия:

- Данные должны храниться в СУБД MongoDB;
- Интерфейс к сущностям должен предоставляться в соответствии со стилем REST;
- API должен быть специфицирован в OpenAPI 3.0 (должен хранится в index.yaml);
- Должен быть создан скрипт по созданию базы данных и таблиц, а также
  наполнению СУБД тестовыми значениями;
- Для каждой коллекции должен быть создан отдельный сервис, реализующий
  CRUD операции.

Task-4:
Должны выполняться следующие условия:

- Необходимо, что бы сервисы работающие с данными обрабатывали только запросы,
  содержащие JWT токен, аутентифицирующий пользователя.
  Сервис, работы с пользователями должен реализовать endpoint «auth» который бы
  осуществлял basic authentication и выдавал JWT токен.

Task-5:
Должны выполняться следующие условия:

- Необходимо модифицировать приложение, которое было создано в предыдущем
  задании. Для сущности, отвечающей за хранение клиента (пользователя) необходимо
  настроить настроить кеширование.
  Должны выполняться следующие условия:
- Кеш должен быть реализован с помощью Redis
- Записи в кеше должны иметь срок жизни
- Необходимо реализовать шаблоны «сквозное чтение» и «сквозная
  запись»
- Необходимо провести сравнение время отклика и максимальной
  пропускной способности сервиса по запросу данных клиента
  (пользователя) с помощью утилиты wrk с использованием кеша и без
  него. Результат тестирования сохранить в репозитории в файле
  performance.md

Task-6:
Должны выполняться следующие условия:

- Необходимо реализовать сервис API Gateway, который будет получать JWT токен в
  User Service и вызывать сервисы согласно варианту задания.
- Для вызова сервисов, согласно варианту задания реализовать паттерн Circuit Breaker.